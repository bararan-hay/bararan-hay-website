<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Անգլերեն-Հայերեն Բառարան</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
		integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body class="bg-light">
	<div class="container">
		<div class="text-center">
			<h3 class="mt-5">Անգլերեն-Հայերեն Բառարան</h3>
			<p class="mt-3 mb-5">Բառարանի մասին տեղեկություն կարող եք գտենլ <a
					href="https://github.com/tigransimonyan/bararan-hay" target="_blank">GitHub</a>-ի իմ էջում։
			</p>
		</div>
		<div class="row justify-content-center">
			<div class="col-lg-8">
				<div class="input-group input-group-lg">
					<input type="text" class="form-control" autofocus placeholder="Գրեք անգլերեն բառը..."
						aria-label="Գրեք անգլերեն բառը" id="search-input" type="text" oninput="handleInput(this)">
				</div>
				<div id="results" class="pt-3 pb-5"></div>
			</div>
		</div>
	</div>
	<script>
		var dictionary = null;
		window.axios
			.get('https://raw.githubusercontent.com/tigransimonyan/baratian-dictionary-assets/master/baratyan-dictionary.tab')
			.then(function (response) {
				dictionary = response.data
			})

		function debounce(func, wait, immediate) {
			var timeout;
			return function () {
				var context = this, args = arguments;
				var later = function () {
					timeout = null;
					if (!immediate) func.apply(context, args);
				};
				var callNow = immediate && !timeout;
				clearTimeout(timeout);
				timeout = setTimeout(later, wait);
				if (callNow) func.apply(context, args);
			};
		};

		var loading = false;
		var searchAndRender = debounce(function (regex) {
			var array = dictionary.match(new RegExp(regex, "gim"));
			var html = ''
			if (array) {
				html += '<ul class="pl-3">'
				array.forEach(function (item) {
					html += '<li class="mt-2">' + item + '</li>'
				})
				html += '</ul>'
			} else {
				html += '<h6 class="text-center mt-5">Շտեմարանում նման բառ չկա ։(</h6>'
			}
			results.innerHTML = html;
			loading = false;
		}, 250);

		function handleInput(e) {
			var text = e.value.trim();
			var regex = "^" + text + ".+\n";
			if (!text || !dictionary) {
				results.innerHTML = "";
				return;
			}
			if (!loading) {
				var html = '<div class="d-flex justify-content-center mt-5">';
				html += '<div class="spinner-border text-dark" role="status">';
				html += '<span class="sr-only">որոնում...</span>';
				html += '</div>';
				html += '</div>';
				results.innerHTML = html;
				loading = true;
			}
			searchAndRender(regex)
		}
	</script>
</body>

</html>